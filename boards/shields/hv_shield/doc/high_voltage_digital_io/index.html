
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>High Voltage Digital I/O &#8212; ARDEP  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/css/custom.css" />
    <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../../_static/clipboard.min.js"></script>
    <script src="../../../../../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="I/O Config Register" href="../io_config_register/index.html" />
    <link rel="prev" title="Changelog" href="../changelog/index.html" />
   
  <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="high-voltage-digital-i-o">
<span id="hv-extension-shield-high-voltage-digital-io"></span><h1>High Voltage Digital I/O<a class="headerlink" href="#high-voltage-digital-i-o" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#digital-input-circuit" id="id7">Digital Input Circuit</a></p></li>
<li><p><a class="reference internal" href="#digital-output-driver" id="id8">Digital Output Driver</a></p>
<ul>
<li><p><a class="reference internal" href="#output-capabilities" id="id9">Output Capabilities</a></p></li>
</ul>
</li>
</ul>
</nav>
<p>The digital IOs are grouped in banks of 8-bit each.
One IO-Bank consists of two driver ICs and one of the 74HC595 Shift Registers (Data Direction Register DDR).
The High voltage supply for each IO bank can be selected individually as explained <a class="reference internal" href="../voltage_supply/index.html#hv-extension-shield-voltage-supply"><span class="std std-ref">here</span></a>.</p>
<p>A MOSFET circuit is used to bring down the High voltage level, and a 60V motor driver provides the 48V capable Push-pull outputs.
The individual components are explained in <a class="reference internal" href="#digital-input-circuit"><span class="std std-ref">Digital Input Circuit</span></a>  and <a class="reference internal" href="#digital-output-circuit"><span class="std std-ref">Digital Output Driver</span></a>.</p>
<p>The IO Interface is implemented as follows:</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../../../../../_images/digital_io.png"><img alt="../../../../../_images/digital_io.png" src="../../../../../_images/digital_io.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-text">Schematic section of the Digital IO interface</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Via the data direction register, the driver IC’s outputs can individually be enabled or disabled.
In a disabled state, the IO can be used as an Input. With the outputs enabled, the IO can be used as an output.</p>
<p>A HIGH state at the output of the high voltage driver IC will immediately be fed back via the MOSFET input structure, basically latching the active state.
For the µC to turn the IO off again, a 330Ohm resistor has been added, which allows the µC to override this positive feedback.
For this to work, the GPIO has to be configured in Push-Pull mode.</p>
<section id="digital-input-circuit">
<span id="id1"></span><h2><a class="toc-backref" href="#id7" role="doc-backlink">Digital Input Circuit</a><a class="headerlink" href="#digital-input-circuit" title="Permalink to this heading">¶</a></h2>
<p>To accept a wide range of digital input voltages, a step-down circuit has been implemented.
It consists of an N-channel MOSFET, which limits the voltage at the input pin.
Using a FET for this purpose has the benefit of lower input currents, compared to a solution involving zener diodes (~4mA at 48V) , while still enabling a wide input voltage range compared to a simple voltage divider, which would only be suitable for a specified input voltage range.</p>
<p>An additional advantage of this structure is that the High Level is independent of the Input voltage.
For Voltages higher than ~3V a logic High will be seen by the Microcontroller.</p>
<p>As the HV Input of this structure is permanently connected to the output drivers, the Input voltage must not exceed the driver’s supply voltage.
Otherwise, its internal ESD protection circuit could activate, damaging the device.</p>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="../../../../../_images/active_input_circuit.png"><img alt="../../../../../_images/active_input_circuit.png" src="../../../../../_images/active_input_circuit.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-text">Active input circuit as implemented on the HV-Shield</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>VFET is the MOSFET’s bias voltage, changing it will change the output level at the µC-Pin.
As a rule of thumb, it can be said, that the output level is ~VFET minus the MOSFET’s threshold voltage.
The generation of this bias voltage is described in more detail in <a class="reference internal" href="../voltage_supply/index.html#hv-extension-shield-voltage-supply"><span class="std std-ref">Voltage Supply</span></a>.</p>
</section>
<section id="digital-output-driver">
<span id="digital-output-circuit"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink">Digital Output Driver</a><a class="headerlink" href="#digital-output-driver" title="Permalink to this heading">¶</a></h2>
<p>The high-voltage digital IOs are implemented using 4-channel half-bridge motor driver ICs (DRV8844).
This was found to be the most space-saving solution thus allowing the implementation of 32 48V-capable digital IOs on the High-Voltage expansion shield.</p>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="../../../../../_images/output_driver.png"><img alt="../../../../../_images/output_driver.png" src="../../../../../_images/output_driver.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-text">HV-Output Driver</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Each output is enabled or disabled via the IO-Config register and driven via the low-voltage GPIOs of the µC if enabled.</p>
<section id="output-capabilities">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Output Capabilities</a><a class="headerlink" href="#output-capabilities" title="Permalink to this heading">¶</a></h3>
<p>The minimum supply voltage of the output drivers is 8V, anything lower will trigger an undervoltage lockout state.</p>
<p>As the IOs are only required to deliver an output current of 15 mA, the high-current capabilities were not yet tested beyond that.
The theoretical maximum output current of the driver IC is 1.75A.
Therefore the maximum output current will be evaluated further and documented accordingly.</p>
<p>According to IPC 2221 voltages above 30 V require increased clearance between electrical structures.
Due to the Pin-Pitch of the output driver circuit, achieving the B2 Clearance of 0.6mm is impossible.
Using bigger packages is not an option, as it would otherwise be impossible to fit the required number of IOs onto the small form factor shield.</p>
<p>As the Output drivers are fully capable of switching 48V it is certainly possible to do so for experimental purposes.
The PCB fulfills the 0.13mm clearance required for conformally coated PCBs.
This enables the option of conformally coating the PCB to comply with the IPC2221 standard.
It is recommended to do so in non-experimental applications with output Voltages surpassing 30V.</p>
<figure class="align-default" id="id5">
<a class="reference internal image-reference" href="../../../../../_images/ipc2221_clearances.png"><img alt="../../../../../_images/ipc2221_clearances.png" src="../../../../../_images/ipc2221_clearances.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-text">Clearances according to IPC2221</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id6">
<a class="reference internal image-reference" href="../../../../../_images/output_pin_to_pin_clearance.png"><img alt="../../../../../_images/output_pin_to_pin_clearance.png" src="../../../../../_images/output_pin_to_pin_clearance.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-text">The output driver’s pin to pin clearance</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../../index.html">ARDEP</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../bootloader/index.html">Bootloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../firmware_loader/index.html">UDS Firmware Loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../console/index.html">Console Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../error_handling/index.html">Error Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../README.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../lib/index.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../scripts/ardep.html">ARDEP Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mercedes/ardep/doc/index.html">ARDEP Board</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">ARDEP HV Shield</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../analog_io/index.html">Analog I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/index.html">Changelog</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">High Voltage Digital I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io_config_register/index.html">I/O Config Register</a></li>
<li class="toctree-l2"><a class="reference internal" href="../voltage_supply/index.html">Voltage Supply</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#pinout">Pinout</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../power_io_shield/doc/index.html">ARDEP Power IO Shield</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../debugging/index.html">Debugging</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">ARDEP HV Shield</a><ul>
      <li>Previous: <a href="../changelog/index.html" title="previous chapter">Changelog</a></li>
      <li>Next: <a href="../io_config_register/index.html" title="next chapter">I/O Config Register</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Frickly Systems GmbH.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 6.2.1</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../../../_sources/boards/shields/hv_shield/doc/high_voltage_digital_io/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>